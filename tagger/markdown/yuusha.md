

--- หน้าที่ 1 ---

NineSama
Author : Tanat Samuttha
yuusha
Thai (THA)
Yuusha
ผู้กล้าฮิมเมลและกลุ่มของเขาต้องการสํารวจดันเจียนลึกลับแห่งหนึ)ง โดยดันเจียนประกอบด้วยห้องทั-งหมด 
 ห้อง
ซึ)งเชื)อมต่อกันด้วยทางเดินทั-งหมด 
 เส้น ซึ)งทางเข้าดันเจียนจะอยู่ที)ห้องหมายเลข 1
ดันเจียนนั-นเป2นสถานที)ที)อันตรายมากเพราะทางเดินแต่ละเส้นจะมีมอนสเตอร์และกับดักมากมาย โดยการที)กลุ่มผู้
กล้าจะสามารถเดินทางจากห้องหมายเลข 
 ไปถึงห้องหมายเลข 
 จะต้องใช้ค่าความเหนื)อยในการเคลียร์เส้น
ทาง 
 หน่วย โดยเมื)อเคลียร์เส้นทางแล้วจะไม่มีมอนสเตอร์เกิดขึ-นใหม่ในเส้นทางนั-นได้อีกทําให้สามารถเดินใน
เส้นทางนั-นอีกครั-งได้โดยไม่รู้สึกเหนื)อย และเส้นทางสามารถเดินได้ทั-งสองทิศทาง
กลุ่มของผู้กล้านั-นมีสุดยอดจอมเวทย์คนหนึ)งซึ)งมีนามว่าฟรีเรน 
ซึ)งฟรีเรนนั-นมีเวทย์มนตร์แห่งจํานวนเฉพาะที)
สามารถลดความเหนื)อยในการเคลียร์เส้นทางได้ ในการร่ายแต่ละครั-งฟรีเรนจะเลือกจํานวนเฉพาะมา 1 จํานวน ที)
สามารถหารค่าความเหนื)อยของเส้นทางนั-นได้พอดีโดยต้องร่ายเวทย์อย่างต่อเนื)องโดยไม่เปลี)ยนจํานวนเฉพาะ
จนกว่าค่าความเหนื)อยของเส้นทางจะเหลือ 1 ไม่เช่นนั-นมอนส์เตอร์จะฟ<- นฟูตัวเองแล้วทําให้ค่าความเหนื)อยในการ
เคลียร์จะกลับมาเท่าเดิม ความเหนื)อยของการร่ายเวทย์จะหาได้จากจํานวนครั-งที)ต้องร่ายเวทย์เพื)อเคลียร์เส้นทางนี-
โดยจะคิดเป2นความเหนื)อยรวมในการเคลียร์ดันเจียนนี-ด้วย


--- หน้าที่ 2 ---

ผู้กล้าฮิมเมลต้องการสํารวจดันเจียนให้ครบทุกห้องแล้วเดินกลับมาที)ทางออกโดยที)เหนื)อยน้อยที)สุด คุณที)เป2นชาว
บ้านแถวนั-นและเป2นคนที)รู้เส้นทางของดันเจียนจึงต้องช่วยเหลือพวกเขาในการสํารวจดันเจียนให้ครบทุกห้องโดย
เหนื)อยน้อยที)สุด
Input :
มีทั-งหมด 
 บรรทัด
บรรทัดแรก : รับจํานวนเต็ม 
M แทนจํานวนห้องและจํานวนทางเดิน ตามลําดับ
บรรทัดที) 2 ถึง 
 : รับจํานวนเต็ม 
 แทนหมายเลขห้องต้นทาง, หมายเลขห้องปลายทาง และ
ความเหนื)อยในการเคลียร์เส้นทางนี-
Output :
มี 1 บรรทัด คือ ค่าความเหนื)อยรวมที)น้อยที)สุดที)ต้องใช้ในการสํารวจดันเจียนให้ครบทุกห้อง
Examples :
ตัวอย่างที# 1
ข้อมูลนําเข้า
ข้อมูลส่งออก
13 17
1 2 6
2 3 8
2 8 4
3 8 10
62
และ
และ


--- หน้าที่ 3 ---

3 4 9
5 4 6
5 6 8
4 6 6
4 7 9
6 7 6
7 9 6
7 12 10
12 13 10
8 11 6
8 9 10
9 10 16
11 13 6
คําอธิบายตัวอย่างที# 1
แผนที)ของดันเจียน


--- หน้าที่ 4 ---

กําหนดให้ลูกศรสีแดงคือการเคลียร์เส้นทางโดยใช้ความเหนื)อยในการเคลียร์ปกติ(ตัวเลขสีแดง)
ลูกศรสีม่วงคือการเคลียร์เส้นทางโดยใช้เวทย์จํานวณเฉพาะทําให้ความเหนื)อยในการเคลียร์เหลือเท่ากับ 1 (ตัวเลข
สีแดง) และใช้ความเหนื)อยในการร่ายเวทย์เท่ากับจํานวณครั-งในการร่าย(ตัวเลขสีม่วง)
ลูกศรสีเขียวคือการเดินย้อนกลับในเส้นทางที)ถูกเคลียร์แล้ว ทําให้ไม่รู้สึกเหนื)อยเพิ)ม 
และลูกศรสีขาวคือการเดินในห้องโดยไม่รู้สึกเหนื)อย
ให้ฟรีเรนร่ายเวทย์ในเส้นทางสีม่วงทําให้ความความเหนื)อยในการเคลียร์เส้นทางนั-นเหลืออยู่ 
1 
ตัวอย่างการคิด
ความเหนื)อยในการใช้เวทย์(ตัวเลขสีม่วง) เช่น เส้นทางจากห้องหมายเลข 9 ไปยังห้องหมายเลข 10 ต้องร่ายเวทย์
จํานวนเฉพาะ 2 เป2นจํานวน 4 ครั-ง เพราะ16/2/2/2/2 = 1 ดังนั-น ความเหนื)อยในการเคลียร์ดันเจียนนี-คือ
6+1+1+1+1+6+1+6+10+1+6+6+3+2+2+3+2+4 = 62
Constraints :
Subtasks :
1. (30 points) 
2. (70 points) ไม่มีเงื)อนไขเพิ)มเติม
Limits :
Time limit: 1 seconds
Memory limit: 256 MB
Author :


--- หน้าที่ 5 ---

ผู้ออกโจทย์ : ธนัท สมุทฐา ( NineSama )
*** โจทย์เหล่านี-จัดทําขึ-นเพื)อการพัฒนาผู้ที)มีความสนใจด้าน Competitive Programming อนุญาตให้มี
การนําไปใช้ในด้านการศึกษา หากมีข้อผิดพลาดหรือข้อสงสัย สามารถติดต่อสอบถามผู้ออกโจทย์เพื)อที)จะ
ปรับปรุงแก้ไขโจทย์ต่อไป ***
Contacts :
Github : Tanat Samuttha
Facebook : ธนัท สมุทฐา
Instagram : nine.nsm
